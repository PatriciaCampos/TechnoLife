CREATE Procedure DaoBoletaInsertar
as
begin
    declare @numero as int
	declare @total as int
	declare @emp int
	declare @pago int
	declare @sucur int
	declare @pedido int
	set @numero =(Select COUNT(*)+1 from boleta)
	
	set @total= (Select SUM(total.cantPre) 
				from (Select (cantidad.ProCant*pres.proPrecio) as cantPre
						from (Select cant as ProCant from detalle_boleta where id_boleta=@numero) cantidad
							,(Select precio as proPrecio from producto_precio) pres) total)
	
	insert into boleta(id_boleta,total,id_empleado,id_forma_pago,id_sucursal,id_pedido_local)
			values(@numero,@total,@emp,@pago,@sucur,@pedido)
	
end
GO


CREATE PROCEDURE DaoBoletaActualizar(
	 @numero  int,
	 @total  int,
	 @emp int,
	 @pago int,
	 @sucur int,
	 @pedido int
)
AS
BEGIN
	UPDATE boleta set @numero = id_boleta ,
	total=@total,@emp=id_empleado,@pago=id_forma_pago,
		@sucur=	id_sucursal,@pedido= id_pedido_local
	WHERE @numero=id_boleta
END
GO



Create Procedure DAOBoletaEliminar(
	@idboleta INTEGER
)
as
begin
delete from boleta 
 where @idboleta = id_boleta
end
GO



CREATE PROCEDURE DAOBoletaBuscar
(
  @id_boleta INTEGER 
)
AS
BEGIN
SELECT * FROM boleta WHERE id_boleta=@id_boleta
END
GO